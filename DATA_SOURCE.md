# 数据来源说明

## 概述

本系统支持两种数据来源：
1. **模拟数据**（默认）：无需网络，快速测试
2. **真实数据**：需要网络，从yfinance获取实时数据

## 模拟数据

### 特点
- ✅ 无需网络连接
- ✅ 运行速度快
- ✅ 数据稳定可重复
- ✅ 适合功能测试和演示

### 使用方法
```bash
# 默认就是模拟数据，无需额外参数
python kline_tool.py -t 1d

# 或者明确指定
python kline_tool.py -t 1w -s AAPL
```

### 数据生成
- 使用随机数生成模拟价格走势
- 包含Open、High、Low、Close、Volume
- 时间范围：默认500天
- 价格波动：基于随机游走模型

## 真实数据

### 特点
- ✅ 使用真实市场数据
- ✅ 数据准确可靠
- ✅ 适合实际分析和研究
- ⚠️ 需要网络连接
- ⚠️ 可能遇到API限流

### 使用方法
```bash
# 使用真实数据（默认1年）
python kline_tool.py --real

# 使用真实数据并指定周期
python kline_tool.py --real -p 2y

# 组合使用
python kline_tool.py --real -t 1w -s AAPL
```

### 数据来源
- 数据源：Yahoo Finance (通过yfinance库)
- 数据类型：OHLCV（开盘价、最高价、最低价、收盘价、成交量）
- 支持周期：1d, 1w, 1m, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max

### 注意事项
1. **API限流**: yfinance免费版有请求频率限制
2. **自动降级**: 如果真实数据获取失败，程序会自动切换到模拟数据
3. **网络要求**: 需要稳定的网络连接
4. **数据延迟**: 真实数据获取可能需要几秒钟

## 命令行参数对比

| 参数 | 模拟数据 | 真实数据 |
|------|---------|---------|
| `-t 1d` | ✅ 默认 | ✅ 支持 |
| `-t 1w` | ✅ 默认 | ✅ 支持 |
| `-t 1m` | ✅ 默认 | ✅ 支持 |
| `-s AAPL` | ✅ 默认 | ✅ 支持 |
| `--real` | ❌ 不需要 | ✅ 必须添加 |
| `-p 1y` | ❌ 不支持 | ✅ 支持 |

## 使用场景建议

### 使用模拟数据的场景
- 📚 学习和教学
- 🧪 功能测试和调试
- 🎯 演示和展示
- ⚡ 快速原型开发
- 📊 算法验证

### 使用真实数据的场景
- 💰 实际投资研究
- 📈 历史数据分析
- 📊 策略回测
- 🔍 市场趋势分析
- 📝 研究报告撰写

## 示例对比

### 模拟数据示例
```bash
$ python kline_tool.py -t 1d -s AAPL
============================================================
K线图绘制工具
============================================================

股票代码: AAPL
时间周期: 日线 (1d)
数据来源: 模拟数据

正在生成 AAPL 的模拟数据...
✓ 成功生成 500 条模拟数据
✓ 使用日线数据: 500 条
✓ 时间范围: 2024-10-06 到 2026-02-17
✓ 最新收盘价: $160.26
```

### 真实数据示例
```bash
$ python kline_tool.py --real -t 1d -s AAPL -p 1y
============================================================
K线图绘制工具
============================================================

股票代码: AAPL
时间周期: 日线 (1d)
数据来源: 真实数据

正在获取 AAPL 的真实数据...
✓ 成功获取 252 条日线数据
✓ 使用日线数据: 252 条
✓ 时间范围: 2024-02-20 到 2025-02-17
✓ 最新收盘价: $173.42
```

### 真实数据失败示例
```bash
$ python kline_tool.py --real -t 1d -s AAPL
============================================================
K线图绘制工具
============================================================

股票代码: AAPL
时间周期: 日线 (1d)
数据来源: 真实数据

正在获取 AAPL 的真实数据...
获取 AAPL 数据失败，2秒后重试... (尝试 1/3)
获取 AAPL 数据失败，4秒后重试... (尝试 2/3)
✗ 获取真实数据失败: Too Many Requests. Rate limited. Try after a while.
  正在切换到模拟数据...
✓ 成功生成 500 条模拟数据
```

## 常见问题

### Q: 为什么默认使用模拟数据？
A: 模拟数据无需网络，可以快速运行和测试功能，适合学习和演示。

### Q: 真实数据获取失败怎么办？
A: 程序会自动切换到模拟数据，确保功能正常运行。稍后再试真实数据即可。

### Q: 模拟数据和真实数据有什么区别？
A: 
- 模拟数据：基于随机算法生成，价格走势是模拟的
- 真实数据：来自Yahoo Finance，是真实的市场数据

### Q: 如何确保使用真实数据？
A: 添加 `--real` 参数：
```bash
python kline_tool.py --real -t 1d -s AAPL
```

### Q: 真实数据可以获取多长时间的数据？
A: 支持多种周期：
- `1y`: 1年
- `2y`: 2年
- `5y`: 5年
- `10y`: 10年
- `max`: 最大可用数据

## 总结

| 特性 | 模拟数据 | 真实数据 |
|------|---------|---------|
| 网络要求 | ❌ 不需要 | ✅ 需要 |
| 运行速度 | ⚡ 快 | 🐢 较慢 |
| 数据准确性 | ❌ 模拟 | ✅ 真实 |
| API限制 | ❌ 无 | ⚠️ 有 |
| 适用场景 | 测试、演示 | 研究、分析 |
| 推荐使用 | 学习阶段 | 生产环境 |
