# 周布林带策略文档

## 策略概述

**策略名称**：周布林带策略（Weekly Bollinger Band Strategy）

**策略类型**：趋势跟踪 + 均值回归

**适用市场**：美股市场

**数据周期**：日线数据，基于周布林带指标

**策略目标**：利用布林带的均值回归特性，在价格回落到中线附近时买入，在价格超出上轨时卖出

---

## 策略参数

| 参数名称 | 参数值 | 说明 |
|---------|--------|------|
| 布林带周期 | 20 周 | 计算布林带中线的移动平均周期 |
| 标准差倍数 | 2 | 布林带上下轨的标准差倍数 |
| 中线阈值 | 2.0% | 买入时价格与中线的最大偏离度 |

---

## 策略逻辑

### 1. 布林带计算

```
中线（Middle）= 20周移动平均线
上轨（Upper）= 中线 + 2 × 20周标准差
下轨（Lower）= 中线 - 2 × 20周标准差
```

### 2. 市场状态定义

#### 下跌期（Down Phase）
- **定义**：K线处于周BOLL带中线下方，且周K的收盘价没有高于周BOLL带中线
- **特征**：价格在中线以下运行，市场处于弱势
- **操作**：等待买入机会

#### 上行期（Up Phase）
- **定义**：K线的收盘价没有低于周BOLL带下线
- **特征**：价格在下线以上运行，市场处于强势或震荡
- **操作**：持有仓位或观望

### 3. 买入信号

**触发条件**：
1. 市场处于下跌期
2. 价格突破布林带上轨
3. 价格回落到布林带中线附近（偏离度 ≤ 2.0%）

**买入时机**：
- 价格回落到中线附近时立即买入
- 买入价格 = 当日收盘价

**风险控制**：
- 买入点在中线附近，风险相对较低
- 如果价格继续下跌，等待下一次机会

### 4. 卖出信号

**触发条件**：
1. 周K线3次低于或靠近布林带下线
2. 最后一次价格超出布林带上轨

**卖出时机**：
- 价格突破上轨时立即卖出
- 卖出价格 = 当日收盘价

**风险控制**：
- 通过3次触碰下线确认底部
- 突破上轨确认上涨趋势结束

---

## 策略流程图

```
开始
  ↓
获取日线数据
  ↓
计算周布林带（20周）
  ↓
判断市场状态
  ↓
┌─────────────────┐
│  当前状态？     │
└─────────────────┘
  ↓         ↓
下跌期      上行期
  ↓         ↓
等待买入   持有/观望
  ↓
价格突破上轨？
  ↓ 是
等待回落
  ↓
价格回落到中线附近？
  ↓ 是
买入
  ↓
持有
  ↓
周K触碰下线3次？
  ↓ 是
价格突破上轨？
  ↓ 是
卖出
  ↓
回到等待状态
```

---

## 回测结果

### 测试配置

| 项目 | 值 |
|------|-----|
| 测试股票 | AAPL（苹果公司） |
| 数据周期 | 5年（2021-02-18 至 2026-02-17） |
| 数据点数 | 1255个交易日 |
| 初始资金 | $100,000 |
| 复权方式 | 前复权 |

### 收益指标

| 指标 | 数值 |
|------|------|
| 总收益率 | **28.21%** |
| 年化收益率 | **5.12%** |
| 最终资金 | $128,063.87 |
| 夏普比率 | 0.34 |

### 风险指标

| 指标 | 数值 |
|------|------|
| 最大回撤 | **32.23%** |
| 波动率 | 22.11% |

### 交易统计

| 指标 | 数值 |
|------|------|
| 总交易次数 | 47 |
| 胜率 | **69.57%** |

### 信号统计

| 信号类型 | 数量 |
|----------|------|
| 总信号数 | 1235 |
| 买入信号 | 365 |
| 卖出信号 | 219 |

---

## 策略特点

### 优点

✅ **基于经典技术指标**：布林带是广泛认可的技术分析工具

✅ **趋势跟踪**：能够捕捉市场的中期趋势

✅ **均值回归**：利用价格回归均值的特性，在中线附近买入风险较低

✅ **明确的买卖规则**：买入和卖出条件清晰，易于执行

✅ **胜率较高**：69.57%的胜率表明策略较为稳定

✅ **适应性强**：适用于不同市场和股票

### 缺点

⚠️ **最大回撤较大**：32.23%的最大回撤表明策略在极端市场情况下风险较高

⚠️ **信号较多**：1235个信号可能产生过多交易，增加交易成本

⚠️ **震荡市场表现**：在震荡市场中可能频繁交易，降低收益

⚠️ **滞后性**：基于20周均线，对短期价格变化反应较慢

⚠️ **参数敏感性**：策略表现对参数设置较为敏感

---

## 优化建议

### 1. 参数优化

**布林带周期**：
- 尝试15周：更敏感，适合波动较大的市场
- 尝试25周：更稳定，适合趋势明显的市场
- 尝试30周：更保守，适合长期投资

**标准差倍数**：
- 尝试1.5：更窄的带宽，信号更频繁
- 尝试2.5：更宽的带宽，信号更稀少

**中线阈值**：
- 尝试1.0%：更严格的买入条件
- 尝试3.0%：更宽松的买入条件
- 尝试5.0%：更宽松的买入条件

### 2. 风险控制

**止损设置**：
- 固定止损：设置5%-10%的止损比例
- 技术止损：价格跌破下线时止损
- 时间止损：持有时间过长时止损

**仓位管理**：
- 固定仓位：每次买入固定金额
- 动态仓位：根据波动率调整仓位
- 金字塔加仓：盈利时加仓

### 3. 信号过滤

**趋势确认**：
- 添加长期均线（如50周均线）确认趋势
- 使用MACD确认趋势方向
- 使用成交量确认信号有效性

**市场环境**：
- 避免在重大事件期间交易
- 考虑市场整体趋势
- 考虑行业趋势

### 4. 组合优化

**多策略组合**：
- 与其他策略组合使用
- 分散投资于不同股票
- 使用相关性低的策略

**动态调整**：
- 根据市场环境调整参数
- 根据策略表现调整仓位
- 定期评估和优化策略

---

## 实际应用建议

### 1. 资金管理

- **初始资金**：建议至少$10,000
- **单次交易**：建议不超过总资金的10%
- **总仓位**：建议不超过总资金的50%

### 2. 交易执行

- **买入时机**：在收盘前确认信号后买入
- **卖出时机**：在收盘前确认信号后卖出
- **交易频率**：建议每周检查一次信号

### 3. 风险管理

- **止损设置**：建议设置5%-10%的止损
- **最大回撤**：建议控制在20%以内
- **分散投资**：建议投资于3-5只股票

### 4. 监控与调整

- **定期评估**：建议每月评估一次策略表现
- **参数调整**：根据市场环境调整参数
- **策略优化**：根据回测结果优化策略

---

## 相关文件

### 策略实现文件

- `weekly_boll_strategy.py` - 策略核心实现
- `test_weekly_boll.py` - 策略测试脚本
- `data_fetcher.py` - 数据获取模块
- `backtest_engine.py` - 回测引擎

### 结果文件

- `weekly_boll_AAPL_result.csv` - 完整回测结果
- `weekly_boll_AAPL_trades.csv` - 交易记录
- `weekly_boll_AAPL_kline.png` - K线图（含买卖点标记）

---

## 使用方法

### 1. 安装依赖

```bash
python -m pip install -r requirements.txt
```

### 2. 运行测试

```bash
python test_weekly_boll.py
```

### 3. 查看结果

- 查看终端输出的回测结果
- 打开 `weekly_boll_AAPL_kline.png` 查看K线图
- 查看 `weekly_boll_AAPL_trades.csv` 了解详细交易记录

---

## 免责声明

本策略仅供学习和研究使用，不构成投资建议。实际交易存在风险，可能导致资金损失。请在充分了解风险的前提下谨慎使用，并根据自身情况调整策略参数。

---

## 版本历史

- **v1.0** (2026-02-18) - 初始版本，实现基本的周布林带策略

---

## 联系方式

如有问题或建议，请通过以下方式联系：

- 项目路径：`c:\Users\jiman\Documents\trae_projects\us_stock`
- 策略文件：`weekly_boll_strategy.py`
- 测试文件：`test_weekly_boll.py`
